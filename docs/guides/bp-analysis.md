# å¢å¼ºç‰ˆBPåˆ†æç³»ç»Ÿè®¾è®¡

## ğŸ¯ ç›®æ ‡

æ”¯æŒå¤šç§è¾“å…¥æºçš„BPåˆ†æï¼š
- âœ… PDF/DOCXæ–‡æ¡£
- âœ… ç½‘ç«™é“¾æ¥
- âœ… PPT/Pitch Deck
- âœ… å¤šä¸ªæ–‡ä»¶ç»„åˆ
- âœ… å›¾æ–‡æ··åˆå†…å®¹
- âœ… åŠ¨æ€è¯„åˆ†æ›´æ–°

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ–¹æ¡ˆï¼šä½¿ç”¨OpenAI Assistants API

**ä¸ºä»€ä¹ˆé€‰æ‹©Assistants APIï¼Ÿ**

1. **å¤šæ¨¡æ€ç†è§£**
   - å¯ä»¥åŒæ—¶å¤„ç†æ–‡æœ¬å’Œå›¾ç‰‡
   - ç†è§£ä¸Šä¸‹æ–‡å’Œå…³è”
   - æ™ºèƒ½æå–å…³é”®ä¿¡æ¯

2. **å¤šæ–‡ä»¶æ”¯æŒ**
   - ä¸€æ¬¡å¯ä¸Šä¼ å¤šä¸ªæ–‡ä»¶
   - æ–‡ä»¶ä¹‹é—´å…³è”åˆ†æ
   - å¢é‡æ·»åŠ ä¿¡æ¯

3. **æŒä¹…åŒ–å¯¹è¯**
   - ä¿æŒåˆ†æä¸Šä¸‹æ–‡
   - åŠ¨æ€æ›´æ–°è¯„åˆ†
   - è¿½é—®å’Œæ¾„æ¸…

4. **å·¥å…·è°ƒç”¨**
   - å¯ä»¥è°ƒç”¨å‡½æ•°è®¡ç®—è¯„åˆ†
   - ç»“æ„åŒ–è¾“å‡º
   - å®æ—¶åé¦ˆ

---

## ğŸ“Š æ”¯æŒçš„è¾“å…¥ç±»å‹

### 1. æ–‡æ¡£ç±»
```
âœ… PDF ï¼ˆé€šè¿‡CloudConvertè½¬æ¢ï¼‰
âœ… DOCX ï¼ˆç›´æ¥æå–ï¼‰
âœ… TXT ï¼ˆç›´æ¥è¯»å–ï¼‰
âœ… PPT/PPTX ï¼ˆæå–æ–‡æœ¬å’Œå›¾ç‰‡ï¼‰
```

### 2. ç½‘ç»œèµ„æº
```
âœ… ç½‘ç«™é“¾æ¥ ï¼ˆçˆ¬å–å¹¶è§£æï¼‰
âœ… Google Docs é“¾æ¥
âœ… Notioné¡µé¢
âœ… åœ¨çº¿Pitch Deck
```

### 3. å¤šåª’ä½“
```
âœ… å›¾ç‰‡ï¼ˆäº§å“æˆªå›¾ã€UI mockupï¼‰
âœ… PPTä¸­çš„å›¾è¡¨
âœ… Infographics
```

### 4. ç»„åˆè¾“å…¥
```
âœ… BPæ–‡æ¡£ + ç½‘ç«™é“¾æ¥
âœ… Pitch Deck + äº§å“demoè§†é¢‘é“¾æ¥
âœ… å¤šä¸ªæ–‡æ¡£ç‰‡æ®µ
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### æµç¨‹1ï¼šå•ä¸€æ–‡æ¡£åˆ†æï¼ˆå½“å‰ï¼‰

```
æ–‡æ¡£ä¸Šä¼  â†’ æå–æ–‡æœ¬ â†’ LLMåˆ†æ â†’ æ˜¾ç¤ºè¯„åˆ†
```

### æµç¨‹2ï¼šå¢å¼ºç‰ˆå¤šæºåˆ†æï¼ˆæ–°ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ›å»ºAnalysis    â”‚
â”‚ Session         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ·»åŠ ä¿¡æ¯æº      â”‚ â† å¯å¤šæ¬¡æ·»åŠ 
â”‚ - æ–‡æ¡£          â”‚
â”‚ - é“¾æ¥          â”‚
â”‚ - PPT           â”‚
â”‚ - å›¾ç‰‡          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Assistantåˆ†æ   â”‚
â”‚ - ç»¼åˆç†è§£      â”‚
â”‚ - ä¸Šä¸‹æ–‡å…³è”    â”‚
â”‚ - å¤šæ¨¡æ€èåˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¡ç®—è¯„åˆ†        â”‚
â”‚ - 4ä¸ªç»´åº¦       â”‚
â”‚ - åŠ¨æ€æ›´æ–°      â”‚
â”‚ - ç½®ä¿¡åº¦        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¾ç¤ºç»“æœ        â”‚
â”‚ - è¯„åˆ†å¡ç‰‡      â”‚
â”‚ - å»ºè®®åé¦ˆ      â”‚
â”‚ - è¿½åŠ ä¿¡æ¯é€‰é¡¹  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» æŠ€æœ¯å®ç°

### 1. ç½‘ç«™å†…å®¹æå–

```typescript
// api/extract-website.ts
import * as cheerio from 'cheerio';

export async function extractWebsite(url: string) {
  const response = await fetch(url);
  const html = await response.text();
  const $ = cheerio.load(html);
  
  // æå–å…³é”®ä¿¡æ¯
  return {
    title: $('title').text(),
    description: $('meta[name="description"]').attr('content'),
    content: $('body').text(),
    images: $('img').map((i, el) => $(el).attr('src')).get(),
    links: $('a').map((i, el) => $(el).attr('href')).get()
  };
}
```

### 2. PPT/PPTXæå–

```typescript
// ä½¿ç”¨ pptxgenjs æˆ– mammoth-likeåº“
import * as pptx from 'pptxgenjs';

export async function extractPPT(buffer: Buffer) {
  // æå–æ–‡æœ¬
  const text = await extractText(buffer);
  // æå–å›¾ç‰‡
  const images = await extractImages(buffer);
  
  return { text, images };
}
```

### 3. OpenAI Assistantsé›†æˆ

```typescript
// api/bp-assistant.ts
import OpenAI from 'openai';

const openai = new OpenAI();

// åˆ›å»ºåˆ†æä¼šè¯
export async function createAnalysisSession() {
  const assistant = await openai.beta.assistants.create({
    name: "BP Analysis Assistant",
    instructions: `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å•†ä¸šè®¡åˆ’åˆ†æä¸“å®¶...`,
    tools: [
      { type: "code_interpreter" },
      { type: "retrieval" }
    ],
    model: "gpt-4-turbo-preview"
  });

  const thread = await openai.beta.threads.create();
  
  return { assistantId: assistant.id, threadId: thread.id };
}

// æ·»åŠ ä¿¡æ¯æº
export async function addInformationSource(
  threadId: string,
  source: {
    type: 'document' | 'website' | 'image' | 'text',
    content: string | Buffer,
    metadata?: any
  }
) {
  let message;
  
  if (source.type === 'document') {
    // ä¸Šä¼ æ–‡ä»¶
    const file = await openai.files.create({
      file: source.content,
      purpose: 'assistants'
    });
    
    message = await openai.beta.threads.messages.create(threadId, {
      role: "user",
      content: "è¯·åˆ†æè¿™ä¸ªæ–‡æ¡£",
      file_ids: [file.id]
    });
  } else if (source.type === 'website') {
    message = await openai.beta.threads.messages.create(threadId, {
      role: "user",
      content: `ä»¥ä¸‹æ˜¯ä»ç½‘ç«™æå–çš„å†…å®¹ï¼š\n\n${source.content}`
    });
  }
  
  return message;
}

// è¿è¡Œåˆ†æ
export async function runAnalysis(
  assistantId: string,
  threadId: string
) {
  const run = await openai.beta.threads.runs.create(threadId, {
    assistant_id: assistantId,
    instructions: "è¯·åŸºäºæä¾›çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè¿›è¡Œå…¨é¢çš„BPåˆ†æï¼Œå¹¶ç»™å‡º4ä¸ªç»´åº¦çš„è¯„åˆ†..."
  });
  
  // ç­‰å¾…å®Œæˆ
  let runStatus = await openai.beta.threads.runs.retrieve(threadId, run.id);
  while (runStatus.status !== 'completed') {
    await new Promise(resolve => setTimeout(resolve, 1000));
    runStatus = await openai.beta.threads.runs.retrieve(threadId, run.id);
  }
  
  // è·å–æ¶ˆæ¯
  const messages = await openai.beta.threads.messages.list(threadId);
  return messages.data[0].content;
}
```

---

## ğŸ¨ UI/UXè®¾è®¡

### åˆ†æé¡µé¢æ”¹è¿›

```tsx
// å½“å‰çŠ¶æ€æ˜¾ç¤º
<AnalysisSession id={sessionId}>
  {/* å·²æ·»åŠ çš„ä¿¡æ¯æº */}
  <SourceList>
    <SourceItem type="document">ç†µå¸§å½±è§†é¡¹ç›®ç®€ä»‹.pdf</SourceItem>
    <SourceItem type="website">https://company.com</SourceItem>
    <SourceItem type="image">äº§å“æˆªå›¾.png</SourceItem>
  </SourceList>
  
  {/* æ·»åŠ æ›´å¤šä¿¡æ¯æº */}
  <AddSourceButton>
    <Option>ä¸Šä¼ æ–‡æ¡£</Option>
    <Option>æ·»åŠ ç½‘ç«™é“¾æ¥</Option>
    <Option>ä¸Šä¼ å›¾ç‰‡</Option>
    <Option>ç²˜è´´æ–‡æœ¬</Option>
  </AddSourceButton>
  
  {/* å½“å‰è¯„åˆ†ï¼ˆå®æ—¶æ›´æ–°ï¼‰*/}
  <ScoreCards>
    <ScoreCard 
      title="AI Insight" 
      score={85} 
      confidence="é«˜"
      sources={["PDF", "Website"]}
    />
    {/* ... å…¶ä»–ç»´åº¦ */}
  </ScoreCards>
  
  {/* åˆ†æå»ºè®® */}
  <Suggestions>
    <Suggestion>
      å»ºè®®è¡¥å……ï¼šå¸‚åœºè§„æ¨¡æ•°æ®
      <AddDataButton>æ·»åŠ ç›¸å…³ä¿¡æ¯</AddDataButton>
    </Suggestion>
  </Suggestions>
</AnalysisSession>
```

---

## ğŸ“ˆ åŠ¨æ€è¯„åˆ†ç³»ç»Ÿ

### è¯„åˆ†é€»è¾‘

```typescript
interface AnalysisScore {
  dimension: string;
  score: number;
  confidence: 'low' | 'medium' | 'high';
  basedOn: string[]; // åŸºäºå“ªäº›ä¿¡æ¯æº
  suggestions: string[]; // æ”¹è¿›å»ºè®®
}

// åˆå§‹è¯„åˆ†ï¼ˆåŸºäºç¬¬ä¸€ä¸ªæ–‡æ¡£ï¼‰
const initialScores = analyzeDocument(document);

// æ·»åŠ æ–°ä¿¡æ¯åæ›´æ–°
const updatedScores = updateScores(
  currentScores,
  newInformation,
  context
);

// ç½®ä¿¡åº¦è®¡ç®—
function calculateConfidence(sources: Source[]): 'low' | 'medium' | 'high' {
  if (sources.length >= 3) return 'high';
  if (sources.length === 2) return 'medium';
  return 'low';
}
```

---

## ğŸ—„ï¸ æ•°æ®åº“æ‰©å±•

### æ–°è¡¨ï¼šanalysis_sessions

```sql
CREATE TABLE analysis_sessions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES profiles(id),
  assistant_id TEXT,
  thread_id TEXT,
  status TEXT DEFAULT 'active',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE analysis_sources (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  session_id UUID NOT NULL REFERENCES analysis_sessions(id),
  source_type TEXT NOT NULL, -- 'document', 'website', 'image', 'text'
  source_url TEXT,
  source_file_id TEXT,
  metadata JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE analysis_scores (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  session_id UUID NOT NULL REFERENCES analysis_sessions(id),
  dimension TEXT NOT NULL,
  score INTEGER NOT NULL,
  confidence TEXT NOT NULL,
  based_on TEXT[] NOT NULL,
  suggestions JSONB,
  version INTEGER DEFAULT 1, -- è¯„åˆ†ç‰ˆæœ¬å·
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);
```

---

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: ç½‘ç«™é“¾æ¥æ”¯æŒï¼ˆæœ€å®¹æ˜“ï¼‰
- [ ] åˆ›å»ºç½‘ç«™å†…å®¹æå–API
- [ ] æ·»åŠ "æ·»åŠ ç½‘ç«™é“¾æ¥"æŒ‰é’®
- [ ] å°†ç½‘ç«™å†…å®¹å‘é€ç»™Assistant
- [ ] æ›´æ–°UIæ˜¾ç¤ºå¤šæº

### Phase 2: PPTæ”¯æŒ
- [ ] æ·»åŠ PPTè§£æåº“
- [ ] æå–æ–‡æœ¬å’Œå›¾ç‰‡
- [ ] ä¸æ–‡æ¡£ç±»ä¼¼å¤„ç†

### Phase 3: OpenAI Assistantsé›†æˆ
- [ ] åˆ›å»ºAssistanté…ç½®
- [ ] å®ç°ä¼šè¯ç®¡ç†
- [ ] å¤šæºä¿¡æ¯ç»¼åˆ

### Phase 4: åŠ¨æ€è¯„åˆ†
- [ ] å®ç°å¢é‡åˆ†æ
- [ ] è¯„åˆ†ç‰ˆæœ¬æ§åˆ¶
- [ ] ç½®ä¿¡åº¦è®¡ç®—

### Phase 5: UIå¢å¼º
- [ ] å¤šæºç®¡ç†ç•Œé¢
- [ ] å®æ—¶è¯„åˆ†æ›´æ–°
- [ ] å»ºè®®å’Œè¿½é—®ç³»ç»Ÿ

---

## ğŸ’° æˆæœ¬è€ƒè™‘

### OpenAI Assistants APIå®šä»·

- **GPT-4 Turbo**: $0.01/1K tokens (input), $0.03/1K tokens (output)
- **æ–‡ä»¶å­˜å‚¨**: $0.20/GB/day
- **Code Interpreter**: $0.03/session

### ä¼°ç®—ï¼ˆæ¯æ¬¡åˆ†æï¼‰
- è¾“å…¥: ~5K tokens Ã— $0.01 = $0.05
- è¾“å‡º: ~2K tokens Ã— $0.03 = $0.06
- **æ€»è®¡**: ~$0.11/æ¬¡åˆ†æ

å¯¹äºå¤šæºåˆ†æï¼Œæˆæœ¬å¯èƒ½æ˜¯å•æ–‡æ¡£çš„2-3å€ï¼Œä½†æä¾›æ›´å…¨é¢çš„ç»“æœã€‚

---

## ğŸ¯ ä¼˜å…ˆçº§å»ºè®®

### ç«‹å³å®æ–½ï¼ˆPhase 1ï¼‰
âœ… **ç½‘ç«™é“¾æ¥æ”¯æŒ**
- æœ€ç®€å•
- ç«‹å³å¢åŠ ä»·å€¼
- ç”¨æˆ·éœ€æ±‚é«˜

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰
âš ï¸ **PPTæ”¯æŒ**
- Pitch Deckå¸¸è§æ ¼å¼
- æŠ€æœ¯å¯è¡Œ
- å·®å¼‚åŒ–åŠŸèƒ½

### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰
ğŸ“Š **OpenAI Assistantså®Œæ•´é›†æˆ**
- éœ€è¦æ›´å¤šå¼€å‘
- æä¾›æœ€å¼ºå¤§åŠŸèƒ½
- ç«äº‰ä¼˜åŠ¿

---

æƒ³è¦æˆ‘å…ˆå®ç°å“ªä¸ªPhaseï¼Ÿæˆ‘å»ºè®®ä»**Phase 1ï¼ˆç½‘ç«™é“¾æ¥æ”¯æŒï¼‰**å¼€å§‹ï¼Œè¿™æ ·å¯ä»¥ç«‹å³çœ‹åˆ°æ•ˆæœï¼

